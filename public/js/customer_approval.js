"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6103],{46565:(t,e,a)=>{a.d(e,{Z:()=>n});var o=a(1519),s=a.n(o)()((function(t){return t[1]}));s.push([t.id,".btn[data-v-0d80ae10]:active,.btn[data-v-0d80ae10]:focus{box-shadow:none;outline:none!important}.margin-bottom-zero label[data-v-0d80ae10]{margin-bottom:0}.div-border[data-v-0d80ae10]{border:1px solid #686868!important}.customMarginUploaded[data-v-0d80ae10]{margin:1px .5rem!important}.customMarginUploadedFirst[data-v-0d80ae10]{margin:.9rem .5rem 0!important}.line-height[data-v-0d80ae10]{line-height:1}",""]);const n=s},21670:(t,e,a)=>{a.d(e,{Z:()=>n});var o=a(1519),s=a.n(o)()((function(t){return t[1]}));s.push([t.id,".button-background-color[data-v-2147b46e]{background:#58a8ff!important}",""]);const n=s},93819:(t,e,a)=>{a.d(e,{Z:()=>n});var o=a(1519),s=a.n(o)()((function(t){return t[1]}));s.push([t.id,".toolbar[data-v-60a5c393]{display:flex;margin:0 1rem}",""]);const n=s},44980:(t,e,a)=>{a.r(e),a.d(e,{default:()=>b});var o=a(61999),s=a(59380),n=a(70749);function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function l(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var o=0,s=function(){};return{s,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r=!0,i=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return r=t.done,t},e:function(t){i=!0,n=t},f:function(){try{r||null==a.return||a.return()}finally{if(i)throw n}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,o=new Array(e);a<e;a++)o[a]=t[a];return o}const u={name:"Approval",props:{id:{type:Number},hideInModel:{type:Boolean,default:!0}},data:function(){return{formFields:{id:0,images:[]},visibleApprovals:!1,axiosParams:{module:"customerApproval"},axiosApprovalParams:{module:"customerApproval/approval"},hideInModal:!1}},beforeCreate:function(){this.$store.getters.isPermitted({resource:"Customer Portal",action:"read"})||this.$router.push("/access-denied")},computed:{customerName:function(){return this.$store.getters.getUserName},collaborationImages:function(){var t,e={uploadedImages:[],needApprovalImages:[],approvedImages:[],customerImages:[]},a=l(this.formFields.images);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(o.approved_at){var s=new Date(o.approved_at);o.custom_approved_at=s.toLocaleString("en-US",{day:"numeric",year:"numeric",month:"short",hour:"numeric",minute:"numeric",second:"numeric"})}if(o.created_at){var n=new Date(o.created_at);o.custom_created_at=n.toLocaleString("en-US",{day:"numeric",year:"numeric",month:"short",hour:"numeric",minute:"numeric",second:"numeric"})}"uploads"==o.status?e.uploadedImages.push(o):"need approval"==o.status?e.needApprovalImages.push(o):"approved"==o.status?e.approvedImages.push(o):"customers"==o.status&&e.customerImages.push(o)}}catch(t){a.e(t)}finally{a.f()}return e}},components:{Toolbar:s.Z,Button:o.Z},mounted:function(){this.formFields.id=this.$props.id?this.$props.id:0,this.getApproval(this.formFields.id)},methods:{getApproval:function(t){var e=this;if(t){var a=Object.values(this.$store.state[this.axiosParams.module].recordList).find((function(e){return e.id==t}));null!=a?this.formFields=function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},a):(this.axiosApprovalParams.id=t,(0,n.JE)(this.axiosApprovalParams,(function(t){console.log(t.data),e.formFields=t.data})))}},saveImage:function(t,e){(new FormData).append("data",JSON.stringify(t)),console.log("this will be done later because we need create permisiion in customer portal in this approval module and we have only read permission")},toggleIcon:function(t){return t?"fa fa-angle-down":"fa fa-angle-right"},imageToPrint:function(t){return"<html><head><script>function step1(){\nsetTimeout('step2()', 10);}\nfunction step2(){window.print();window.close();}\n<\/script></head><body onload='step1()'> <img src='"+t+"' style='width: 100vw;'>\n</body></html>"},printImage:function(t){var e=window.open("about:blank","_new");e.document.open(),e.document.write(this.imageToPrint(window.location.origin+"/"+t)),e.document.close()},downloadImage:function(t){t="/"+t;var e=document.createElement("a");e.href=t;var a={images:"",collaboration:"",_:""};t=t.replace(/images|_|collaboration/gi,(function(t){return a[t]})),e.download=t,document.body.appendChild(e),console.log(e),e.click(),document.body.removeChild(e)},moveFile:function(t){if(this.formFields.images.filter((function(e){return e==t.img}))[0].status=t.moveTo,"need approval"==t.moveTo){var e=this.$store.state.auth.user?this.$store.state.auth.user:null;t.img.moved_by=e.name,this.addTask("collaboration",t)}if("approved"==t.moveTo){t.img.user_id=this.$store.state.auth.user.id?this.$store.state.auth.user.id:null,t.img.user=this.$store.state.auth.user?this.$store.state.auth.user:null;var a=new Date,o=[a.getMonth(),a.getDate(),a.getFullYear()],s=o[0],n=o[1],r=o[2],i=[a.getHours(),a.getMinutes(),a.getSeconds()],l=i[0],c=i[1],u=i[2];t.img.approved_at="".concat(r,"-").concat(s,"-").concat(n," ").concat(l,":").concat(c,":").concat(u)}"customers"==t.moveTo&&(this.customer_message="File has been moved to customer view section",this.customer_image=t.img.path,this.customer_image_name=t.img.name,this.sendCustomerViewMail()),this.saveImage(t.img,!1)}}};var m=a(93379),d=a.n(m),v=a(46565),p={insert:"head",singleton:!1};d()(v.Z,p);v.Z.locals;const b=(0,a(51900).Z)(u,(function(){var t=this,e=t._self._c;return e("div",[e("h5",{staticClass:"mx-2 my-1 custom-view-heading"},[t._v("Customer Portal")]),t._v(" "),e("div",{staticClass:"bg-toolbar my-2 p-1"},[e("Toolbar",{attrs:{customerName:t.customerName}})],1),t._v(" "),e("div",[e("Button",{attrs:{approval:!0}})],1),t._v(" "),e("hr",{staticClass:"my-3"}),t._v(" "),e("b-form",{staticClass:"div-shadow bg-white rounded mx-2 mb-2"},[e("div",{staticClass:"d-flex justify-content-center title-style col-md-12 my-2"},[t._v("\n            APPROVALS\n        ")]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-1 px-4 mb-1"},[e("label",[t._v("Approvals")])]),t._v(" "),e("div",{staticClass:"col-md-5 px-4 mb-1"},[e("b-button",{class:t.visibleApprovals?"btn btn-sm bg-white text-dark  text-left border w-100":"w-100 btn btn-sm  bg-white text-dark text-left border collapsed",attrs:{"aria-expanded":t.visibleApprovals?"true":"false","aria-controls":"collapse-approval"},on:{click:function(e){t.visibleApprovals=!t.visibleApprovals}}},[e("i",{class:t.toggleIcon(t.visibleApprovals)}),t._v(" Click here to open or close the\n                            approval section\n                        ")]),t._v(" "),e("b-collapse",{attrs:{id:"collapse-approval"},model:{value:t.visibleApprovals,callback:function(e){t.visibleApprovals=e},expression:"visibleApprovals"}},[e("div",{staticClass:"flex-column flex-grow-1 border rounded bg-white"},[e("div",{staticClass:"flex-column px-1 pb-1"},[t._l(t.collaborationImages.needApprovalImages,(function(a,o){return e("div",{staticClass:"flex-column p-0 my-2 py-1 div-border"},[e("div",[e("div",{staticClass:"flex-column flex-grow-1 text-center d-flex margin-bottom-zero"},[e("label",{staticClass:"font-weight-bold"},[t._v("Unviewed by customer")]),t._v(" "),e("label",{staticClass:"text-info"},[t._v("Email "+t._s(0==a.sent_mail?"not sent":"sent")+"  to collaborator(s)")]),t._v(" "),e("label",{staticClass:"text-info"},[t._v("Moved by "+t._s(a.moved_by))])])]),t._v(" "),e("div",[e("div",{staticClass:"flex-column mx-2"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4"},[e("img",{staticClass:"h-100 w-100 mx-1 border p-1 rounded my-1 custom-image",attrs:{src:"/".concat(a.path)}})]),t._v(" "),e("div",{staticClass:"flex-column mt-1 col-md-4 line-height"},[e("label",{staticClass:"font-weight-bold custom-label customMarginUploadedFirst"},[t._v(t._s(a.name.length>20?a.name.substring(0,20)+"...":a.name))]),t._v(" "),e("label",{staticClass:"text-info custom-label customMarginUploaded"},[t._v(t._s(a.size))]),t._v(" "),e("label",{staticClass:"text-info custom-label customMarginUploaded"},[t._v(t._s(a.custom_created_at))]),t._v(" "),e("label",{staticClass:"custom-label customMarginUploaded"},[t._v(t._s(a.uploaded_by))]),t._v(" "),e("div",[e("button",{staticClass:"btn btn-sm my-1 bg-white",attrs:{type:"button"},on:{click:function(e){return t.printImage(a.path),!1}}},[e("i",{staticClass:"fa fa-print fa-lg"})]),t._v(" "),e("button",{staticClass:"btn btn-sm my-1 bg-white ml-n2",attrs:{type:"button"},on:{click:function(e){return t.downloadImage(a.path)}}},[e("i",{staticClass:"fa fa-arrow-circle-down fa-lg"})])])]),t._v(" "),e("div",{staticClass:"flex-column col-md-4"},["need approval"==a.status?e("div",{staticClass:"flex-column"},[e("button",{staticClass:"btn-info w-100 my-1 custom-infobtn-toolbar custom-infobtn-text",attrs:{type:"button"},on:{click:function(e){return t.moveFile({moveTo:"approved",img:a})}}},[t._v("Accept as Customer")]),t._v(" "),e("button",{staticClass:"btn-info w-100 my-1 custom-infobtn-toolbar custom-infobtn-text",attrs:{type:"button"},on:{click:function(t){}}},[t._v("Reject as Customer")])]):t._e()])]),t._v(" "),e("div",{staticClass:"flex-column flex-wrap"},[t.hideInModal?t._e():e("div",{staticClass:"flex-column"},[e("label",{staticClass:"font-weight-bold"},[t._v("Rendering notes for customer:")]),t._v(" "),a.notes?e("label",{staticClass:"custom-label customMarginUploaded"},[t._v(t._s(a.notes))]):t._e()])])])])])})),t._v(" "),t._l(t.collaborationImages.approvedImages,(function(a,o){return e("div",{staticClass:"flex-column p-0 my-2 py-1 div-border"},[e("div",[e("div",{staticClass:"flex-column flex-grow-1 text-center d-flex margin-bottom-zero"},[e("label",{staticClass:"font-weight-bold text-primary"},[t._v("Approved by "+t._s(a.user?a.user.name:t.username))]),t._v(" "),e("label",{staticClass:"text-info"},[t._v("Admin note:")]),t._v(" "),e("label",{staticClass:"text-info"},[t._v(t._s(a.custom_approved_at))]),t._v(" "),e("label",[t._v("Acknowledged by "+t._s(a.user?a.user.name:t.username)+"  @ "+t._s(a.custom_approved_at))]),t._v(" "),"Customer"==a.user.role.title?e("label",{staticClass:"font-weight-bold"},[t._v("Accepted by Customer")]):t._e()])]),t._v(" "),e("div",[e("div",{staticClass:"flex-column mx-2"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4"},[e("img",{staticClass:"h-100 w-100 mx-1 border p-1 rounded my-1 custom-image",attrs:{src:"/".concat(a.path)}})]),t._v(" "),e("div",{staticClass:"flex-column mt-1 col-md-4 line-height"},[e("label",{staticClass:"font-weight-bold custom-label customMarginUploadedFirst"},[t._v(t._s(a.name.length>20?a.name.substring(0,20)+"...":a.name))]),t._v(" "),e("label",{staticClass:"text-info custom-label customMarginUploaded"},[t._v(t._s(a.size))]),t._v(" "),e("label",{staticClass:"text-info custom-label customMarginUploaded"},[t._v(t._s(a.custom_created_at))]),t._v(" "),e("label",{staticClass:"custom-label customMarginUploaded"},[t._v(t._s(a.uploaded_by))]),t._v(" "),e("div",[e("button",{staticClass:"btn btn-sm my-1 bg-white",attrs:{type:"button"},on:{click:function(e){return t.printImage(a.path),!1}}},[e("i",{staticClass:"fa fa-print fa-lg"})]),t._v(" "),e("button",{staticClass:"btn btn-sm my-1 bg-white ml-n2",attrs:{type:"button"},on:{click:function(e){return t.downloadImage(a.path)}}},[e("i",{staticClass:"fa fa-arrow-circle-down fa-lg"})])])]),t._v(" "),e("div",{staticClass:"flex-column my-auto col-md-4"},["Customer"!=a.user.role.title?e("button",{staticClass:"btn-info w-100 my-1 custom-infobtn-toolbar custom-infobtn-text",attrs:{type:"button"},on:{click:function(e){return t.moveFile({moveTo:"need approval",img:a})}}},[t._v("Reject as Customer")]):t._e()])]),t._v(" "),e("div",{staticClass:"flex-column"},[t.hideInModal?t._e():e("div",{staticClass:"flex-column flex-wrap"},[e("label",{staticClass:"font-weight-bold"},[t._v("Rendering notes for customer:")]),t._v(" "),a.notes?e("label",{staticClass:"custom-label customMarginUploaded"},[t._v(t._s(a.notes))]):t._e()])])])])])}))],2)])])],1)])])],1)}),[],!1,null,"0d80ae10",null).exports},61999:(t,e,a)=>{a.d(e,{Z:()=>l});const o={name:"Button",props:{invoice:{type:Boolean,default:!1},orderStatus:{type:Boolean,default:!1},approval:{type:Boolean,default:!1},collaboration:{type:Boolean,default:!1}},data:function(){return{axiosParams:{module:"customerToolButton"}}},computed:{},methods:{}};var s=a(93379),n=a.n(s),r=a(21670),i={insert:"head",singleton:!1};n()(r.Z,i);r.Z.locals;const l=(0,a(51900).Z)(o,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"d-flex justify-content-center"},[e("div",{staticClass:"toolbar"},[e("router-link",{staticClass:"btn-info btn-sm mx-1 custom-dangerbtn-toolbar custom-infobtn-text py-2 text-decoration-none",class:t.invoice?"button-background-color":"",attrs:{to:"/invoice-list",exact:""}},[t._v("Invoice")]),t._v(" "),e("router-link",{staticClass:"btn-info btn-sm mx-1 custom-dangerbtn-toolbar custom-infobtn-text py-2 text-decoration-none",class:t.orderStatus?"button-background-color":"",attrs:{to:"/customer-order-status-list",exact:""}},[t._v("Order Status")]),t._v(" "),e("router-link",{staticClass:"btn-info btn-sm mx-1 custom-dangerbtn-toolbar custom-infobtn-text py-2 text-decoration-none",class:t.approval?"button-background-color":"",attrs:{to:"/customer-approval-list",exact:""}},[t._v("Approvals")]),t._v(" "),e("router-link",{staticClass:"btn-info btn-sm mx-1 custom-dangerbtn-toolbar custom-infobtn-text py-2 text-decoration-none",class:t.collaboration?"button-background-color":"",attrs:{to:"/customer-collaboration-list",exact:""}},[t._v("Collaboration")])],1)])])}),[],!1,null,"2147b46e",null).exports},59380:(t,e,a)=>{a.d(e,{Z:()=>l});const o={name:"Toolbar",props:{customerName:{type:String,default:null}},computed:{},data:function(){return{axiosParams:{module:"CustomerPortal"},searchTerm:""}},methods:{}};var s=a(93379),n=a.n(s),r=a(93819),i={insert:"head",singleton:!1};n()(r.Z,i);r.Z.locals;const l=(0,a(51900).Z)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex align-items-center w-100"},[e("div",{staticClass:"toolbar d-flex ml-auto"},[t._v("\n        Welcome "+t._s(t.customerName)+"!\n    ")]),t._v(" "),t._m(0)])}),[function(){var t=this._self._c;return t("div",{staticClass:"toolbar ml-auto"},[t("div",{staticClass:"d-flex mt-1"},[t("img",{staticClass:"toolbar-image mx-1 mt-1",attrs:{src:"/images/video-chat.png",width:"26",height:"26"}}),this._v(" "),t("img",{staticClass:"toolbar-image mx-1",attrs:{src:"/images/help-icon.png",width:"30",height:"30"}})])])}],!1,null,"60a5c393",null).exports}}]);