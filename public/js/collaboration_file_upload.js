"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8479],{42013:(e,t,a)=>{a.d(t,{Z:()=>o});var i=a(1519),s=a.n(i)()((function(e){return e[1]}));s.push([e.id,".main[data-v-cef8c9ac]{height:85vh}.custom-row[data-v-cef8c9ac]{margin:.5rem 0;padding-left:1rem}.custom-row[data-v-cef8c9ac],.custom-row div[data-v-cef8c9ac]{display:flex}.custom-row div label[data-v-cef8c9ac]{margin:auto .5rem;white-space:nowrap!important}",""]);const o=s},81298:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var i=a(70749);function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const r={name:"File-upload",props:{id:{type:String}},computed:{file:{get:function(){return this.formFields.upload_image},set:function(e){e&&e.size/1e6>2?(alert("File must be less than 2MB"),this.$set(this.formFields,"upload_image",null)):this.$set(this.formFields,"upload_image",e)}}},data:function(){return{formFields:{id:0},axiosParams:{module:"collaboration"},saveDisabled:!1,toastHider:!1}},metaInfo:function(){return{title:"File Upload"}},mounted:function(){var e=this,t={str:this.$props.id,type:"decrypt"},a=new FormData;a.append("data",JSON.stringify(t)),(0,i.mP)(a,(function(t){console.log(t),e.formFields.id=t.data,e.getCollaboration(e.formFields.id)}))},methods:{getCollaboration:function(e){var t=this;if(e){var a=Object.values(this.$store.state[this.axiosParams.module].recordList).find((function(t){return t.id==e}));null!=a?this.formFields=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a):(this.axiosParams.id=e,(0,i.JE)(this.axiosParams,(function(e){t.formFields=e.data})))}},storeCollaboration:function(){var e=this;this.saveDisabled=!0;var t=this.formFields,a=new FormData;a.append("data",JSON.stringify(t)),a.append("image_file",this.formFields.upload_image),(0,i.K)(this.axiosParams,a,(function(t){if(t.data.errorInfo){var a=t.data.errorInfo[t.data.errorInfo.length-1];e.makeToast({title:"Error",message:a,variant:"danger"})}else{var i="Record Successfully ".concat(e.formFields.id?"Updated":"Added");e.makeToast({title:"Success",message:i,variant:"success"}),e.formFields=t.data,e.axiosParams.data=t.data,e.$store.commit("appendOrUpdateInRecordList",e.axiosParams),e.$store.commit("appendOrUpdateInRecordList",{module:"order",data:e.formFields.order})}}))},getRecords:function(){var e=this;0==this.$store.state[this.axiosParams.module].recordList.length&&this.$store.dispatch("getModuleInfo",this.axiosParams),(0,i.cO)({module:"collaboration/collaboratorTypes"},(function(t){e.collaboratorTypes=t.data}))},uploadImage:function(){var e=this;this.toastHider=!0,this.makeToast({title:"Uploading",message:"Uploading images...",variant:"success"});var t={collaboration:this.formFields.id,uploaded_from:"uploads"},a=new FormData;a.append("image_file",this.formFields.upload_image),a.append("data",JSON.stringify(t)),this.formFields.upload_image=null,(0,i.K)({module:"collaboration/uploadImage"},a,(function(t){if(t.data.errorInfo){e.toastHider=!1,e.$bvToast.hide("collaboration-toast");var a=t.data.errorInfo[t.data.errorInfo.length-1];e.makeToast({title:"Error",message:a,variant:"danger"})}else{e.toastHider=!1,e.$bvToast.hide("collaboration-toast");e.makeToast({title:"Success",message:"Image Uploaded",variant:"success"}),e.formFields.images.push(t.data)}}))},previewImage:function(e){var t=e.target;if(t.files[0].size/1024/1024>2||-1==t.files[0].type.indexOf("image"))return this.makeToast({title:"Error",message:"Invalid image type or file size exceeds 2 MB",variant:"danger",duration:5e3}),this.$refs.inputFile.reset(),!1},sendMail:function(){var e=this;if(0!=this.sendToList.length){this.toastHider=!0,this.makeToast({title:"Sending",message:"Sending mail...",variant:"success"});var t=this.sendToList,a=this.mailText,s={};s.sendTo=t,s.message=a,s.link=this.uploadLink,s.order=this.order.id;var o=new FormData;o.append("data",JSON.stringify(s)),(0,i.Yb)(this.axiosParams,o,(function(t){e.toastHider=!1,e.$bvToast.hide("collaboration-toast"),"sent"==t.data?e.makeToast({title:"Mail Sent",message:"Mail sent successfully",variant:"success"}):e.makeToast({title:"Error",message:t.data,variant:"danger",duration:5e3}),console.log(t.data)}))}else this.makeToast({title:"Warning",message:"Please select a user",variant:"warning"})},makeToast:function(e){this.$bvToast.toast(e.message,{id:"collaboration-toast",title:e.title,variant:e.variant,toaster:"b-toaster-top-center",autoHideDelay:e.duration?e.duration:2e3,noAutoHide:this.toastHider,noCloseButton:!0}),this.saveDisabled=!1}}};var n=a(93379),l=a.n(n),d=a(42013),c={insert:"head",singleton:!1};l()(d.Z,c);d.Z.locals;const m=(0,a(51900).Z)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"col-md-12 d-flex main"},[t("div",{staticClass:"custom-row flex-column m-auto",attrs:{id:"file-upload-modal"}},[t("b-form-group",{staticClass:"dragdrop m-0",attrs:{id:"fileInput"}},[t("b-form-file",{ref:"inputFile",attrs:{accept:"image/*",placeholder:"Drag&Drop or select file ..."},on:{change:e.previewImage},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),e._v(" "),t("label",{staticClass:"file-size mx-auto"},[e._v("Max file size : 2MB")]),e._v(" "),t("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:!e.formFields.upload_image},on:{click:function(t){return e.uploadImage()}}},[e._v("\n            Upload\n        ")])],1)])}),[],!1,null,"cef8c9ac",null).exports}}]);